---
title: "decompr: trade flow decomposition for Global Value Chain analysis"
author: "Bastiaan Quast and Victor Kümmritz"
date: "Wednesday, November 26, 2014"
output: md_document
bibliography: bibliography.bib
---

```{r load-package, echo=FALSE}
library(decompr)
```

Abstract
===============
The R package **decompr** implements algorithms for the analysis of Global Value Chains.
Two methods for gross export flow decomposition using Inter-Country Input-Output tables are provided.
The first method is the **Wang-Wei-Zhu** [-@wang2014quantifying] algorithm which splits bilateral gross exports into 16 value added components.
These components can broadly be divided into domestic and foreign value added.
The second method concerns a **source decomposition** algorithm.
This derives the value added origin of a country-industry’s exports by source country and source industry,
by applying the basic Leontief insight to gross trade data.
This article summarises the methodology of the algorithms and describes the format of the input and output data.


Introduction
================
Global Value Chains (GVCs) have become a central factor in trade and development policy.
Policy makers from different countries and institutions have placed them at the center of their agenda
and continuously emphasize their growing importance for both international trade and economic development.
However, analysing this phenomenon empirically requires complex matrix manipulations,
since the relevant data is only available in the form of gross flows.
This package enables researchers with little background in matrix algebra and linear programming
to easily derive standard GVC indicators for statistical analysis.

As mentioned above, **decompr** uses Inter-Country Input-Output tables,
such as those published by the OECD, WIOD, or national statistics bureaus.
These tables state input-output relationships in gross terms
between industries within and across countries.

For instance, let us look at the example of the leather used in German manufactured car seats.
The ICIOs quantify the value of inputs that the Turkish leather and textiles industry
supplies to the German transport equipment industry.

The problem of these gross trade flows,
is that they do not reveal how much of the value was added in the supplying industry,
and how much of the value was added in previous stages of production,
performed by other industries or even countries.

The decomposition of gross trade flows solves this problem,
by reallocating the value of intermediate goods used by industries to the original producers.
In our example, the use of Argentinian agricultural produce (raw hides)
is subtracted from the Turkish leather industry and added to the Argintinian agricultural industry.

Data
=================

A sample data set of Input-Output tables is included.
In order to save space and speed up computations, the included data set uses regional aggregates,
instead of countries.

Load the included data set of WIOD regional Input-Output tables.

```{r load-data}
data(wiod)
```

A key step in loading the data is making sure that the dimensions of the data inputs are correct,
in the sample data we have **G = 7** (generally countries, here regions) and **N = 34** (number of industries).

```{r data-dimensions}
dim(intermediate_demand) # (2 + GN + totals) x (2 + GN)
dim(final_demand)        # (2 + GN + totals) x (2 + G*5)
```

Note thata **G** and **N** are automatically inferred by decompr from the dimensions of the data set.

When importing data, be sure to specify **stringsAsFactors = FALSE** and to **header=FALSE**,
as the Input-Output tables use two header lines (country and industry), e.g:

```{r manual-import, eval=FALSE}
final_demand <- read.csv( file             = "final_demand.csv",
                          header           = FALSE,
                          stringsAsFactors = FALSE               )

```


Methods
=================
 * Small derivation

```{r load_tables}
elements <- load_tables( x = intermediate_demand,
                         y = final_demand         )
```

Wang Wei Zhu decomposition
------------------------------
We can now decompose the elements using the Wang-Wei-Zhu (or source) decomposition.
```{r wwz}
wwz <- wwz( elements )
```

In addition, a wrapper function called **decomp** is provided which performs both steps at once.
Though it is recomended that the seperate functions be used for large data sets.

```{r wwz-wrapper}
wwz2 <- decomp( x = intermediate_demand,
                y = final_demand,
                method = "wwz"           )
```

Note that **wwz** is the default method.

The output data is as follows

```{r wwz-eval}
str(wwz)
```

Source decomposition
---------------------------------------
 * Small derivation
 * R demonstration using WIOD data


We can now decompose the elements using the Source decomposition.
```{r source}
source <- kung_fu( elements )
```

In addition, a wrapper function called **decomp** is provided which performs both steps at once.
Though it is recomended that the atomic functions be used for large data sets.

```{r source-wrapper}
source2 <- decomp( x = intermediate_demand,
                y = final_demand,
                method = "source"           )
```

The output data is as follows

```{r source-eval}
str(source)
```

Discussion
------------------------


Acknowledgements
--------------------
FNS
Fei Wang


References
----------------------
