Abstract
========

The R package **decompr** implements algorithms for the analysis of
Global Value Chains. Two methods for gross export flow decomposition
using Inter-Country Input-Output tables are provided. The first method
is the **Wang-Wei-Zhu** (2014) algorithm which splits bilateral gross
exports into 16 value added components. These components can broadly be
divided into domestic and foreign value added. The second method
concerns a **source decomposition** algorithm. This derives the value
added origin of a country-industry’s exports by source country and
source industry, by applying the basic Leontief insight to gross trade
data. This article summarises the methodology of the algorithms and
describes the format of the input and output data.

Introduction
============

Global Value Chains (GVCs) have become a central factor in trade and
development policy. Policy makers from different countries and
institutions have placed them at the center of their agenda and
continuously emphasize their growing importance for both international
trade and economic development. However, analysing this phenomenon
empirically requires complex matrix manipulations, since the relevant
data is only available in the form of gross flows. This package enables
researchers with little background in matrix algebra and linear
programming to easily derive standard GVC indicators for statistical
analysis.

As mentioned above, **decompr** uses Inter-Country Input-Output tables,
such as those published by the OECD, WIOD, or national statistics
bureaus. These tables state input-output relationships in gross terms
between industries within and across countries.

For instance, let us look at the example of the leather used in German
manufactured car seats. The ICIOs quantify the value of inputs that the
Turkish leather and textiles industry supplies to the German transport
equipment industry.

The problem of these gross trade flows, is that they do not reveal how
much of the value was added in the supplying industry, and how much of
the value was added in previous stages of production, performed by other
industries or even countries.

The decomposition of gross trade flows solves this problem, by
reallocating the value of intermediate goods used by industries to the
original producers. In our example, the use of Argentinian agricultural
produce (raw hides) is subtracted from the Turkish leather industry and
added to the Argintinian agricultural industry.

Data
====

A sample data set of Input-Output tables is included. In order to save
space and speed up computations, the included data set uses regional
aggregates, instead of countries.

Load the included data set of WIOD regional Input-Output tables.

    data(wiod)

A key step in loading the data is making sure that the dimensions of the
data inputs are correct, in the sample data we have **G = 7** (generally
countries, here regions) and **N = 34** (number of industries).

    dim(intermediate_demand) # (2 + GN + totals) x (2 + GN)

    ## [1] 255 247

    dim(final_demand)        # (2 + GN + totals) x (2 + G*5)

    ## [1] 247  37

Note thata **G** and **N** are automatically inferred by decompr from
the dimensions of the data set.

When importing data, be sure to specify **stringsAsFactors = FALSE** and
to **header=FALSE**, as the Input-Output tables use two header lines
(country and industry), e.g:

    final_demand <- read.csv( file             = "final_demand.csv",
                              header           = FALSE,
                              stringsAsFactors = FALSE               )

Methods
=======

-   Small derivation

<!-- -->

    elements <- load_tables( x = intermediate_demand,
                             y = final_demand         )

Wang Wei Zhu decomposition
--------------------------

We can now decompose the elements using the Wang-Wei-Zhu (or source)
decomposition.

    wwz <- wwz( elements )

In addition, a wrapper function called **decomp** is provided which
performs both steps at once. Though it is recomended that the seperate
functions be used for large data sets.

    wwz2 <- decomp( x = intermediate_demand,
                    y = final_demand,
                    method = "wwz"           )

Note that **wwz** is the default method.

The output data is as follows

    str(wwz)

    ##  num [1:1960, 1:25] 0 9199 756 265 239 ...
    ##  - attr(*, "dimnames")=List of 2
    ##   ..$ : chr [1:1960] "Euro-zone.c1.Euro-zone" "Euro-zone.c1.Other EU" "Euro-zone.c1.NAFTA" "Euro-zone.c1.China" ...
    ##   ..$ : chr [1:25] "DVA_FIN" "DVA_INT" "DVA_INTrexI1" "DVA_INTrexF" ...

Source decomposition
--------------------

-   Small derivation
-   R demonstration using WIOD data

We can now decompose the elements using the Source decomposition.

    source <- kung_fu( elements )

In addition, a wrapper function called **decomp** is provided which
performs both steps at once. Though it is recomended that the atomic
functions be used for large data sets.

    source2 <- decomp( x = intermediate_demand,
                    y = final_demand,
                    method = "source"           )

The output data is as follows

    str(source)

    ## 'data.frame':    245 obs. of  245 variables:
    ##  $ Euro-zone.c1 : num  23804 133.9 948.9 30.7 7 ...
    ##  $ Euro-zone.c2 : num  14.381 6585.184 8.732 3.175 0.731 ...
    ##  $ Euro-zone.c3 : num  17353.8 436.5 51581.5 114.9 29.5 ...
    ##  $ Euro-zone.c4 : num  512 134 181 29070 130 ...
    ##  $ Euro-zone.c5 : num  273.1 43.3 452.6 277.2 10071.6 ...
    ##  $ Euro-zone.c6 : num  1064.11 39.87 64.26 12.85 3.87 ...
    ##  $ Euro-zone.c7 : num  668.3 234 158 86.7 10.6 ...
    ##  $ Euro-zone.c8 : num  119.54 3887.68 122.62 39.39 8.06 ...
    ##  $ Euro-zone.c9 : num  1019.3 1788.5 1396.9 327.2 43.4 ...
    ##  $ Euro-zone.c10: num  404.5 202.7 142.8 160.2 15.2 ...
    ##  $ Euro-zone.c11: num  65.34 1159.2 48.94 25.79 5.39 ...
    ##  $ Euro-zone.c12: num  366.9 1063.8 279 159.9 42.1 ...
    ##  $ Euro-zone.c13: num  467 631.3 399.2 209.4 52.4 ...
    ##  $ Euro-zone.c14: num  426 564 382 214 42 ...
    ##  $ Euro-zone.c15: num  640 762 520 556 119 ...
    ##  $ Euro-zone.c16: num  339.6 129.2 99.9 189.5 62 ...
    ##  $ Euro-zone.c17: num  23.514 207.509 11.975 3.958 0.981 ...
    ##  $ Euro-zone.c18: num  44.14 104.07 15.99 9.29 1.73 ...
    ##  $ Euro-zone.c19: num  6.316 6.152 6.6 2.136 0.477 ...
    ##  $ Euro-zone.c20: num  242.5 133.2 174.9 54 28.6 ...
    ##  $ Euro-zone.c21: num  46.25 22.65 34.76 18.1 3.22 ...
    ##  $ Euro-zone.c22: num  371.95 23.92 633.08 13.79 1.92 ...
    ##  $ Euro-zone.c23: num  58.03 175.82 53.77 18.26 3.98 ...
    ##  $ Euro-zone.c24: num  282.68 196.96 326.27 31.3 6.02 ...
    ##  $ Euro-zone.c25: num  95 253.5 103.7 24.4 4.6 ...
    ##  $ Euro-zone.c26: num  86.63 85.27 83.4 16.36 3.42 ...
    ##  $ Euro-zone.c27: num  22.98 29.8 20.71 7.21 1.61 ...
    ##  $ Euro-zone.c28: num  99.51 91.6 93.72 22.19 4.34 ...
    ##  $ Euro-zone.c29: num  2.9855 2.6039 1.1268 0.3191 0.0593 ...
    ##  $ Euro-zone.c30: num  243.4 204.6 243.1 63.6 11.5 ...
    ##  $ Euro-zone.c31: num  17.328 8.874 10.932 2.356 0.544 ...
    ##  $ Euro-zone.c32: num  5.0692 2.4314 6.104 0.429 0.0687 ...
    ##  $ Euro-zone.c33: num  6.107 1.832 8.451 1.313 0.138 ...
    ##  $ Euro-zone.c34: num  42.28 21.62 35.26 9.94 1.58 ...
    ##  $ Euro-zone.c35: num  0 0 0 0 0 0 0 0 0 0 ...
    ##  $ Other EU.c1  : num  161.9 27.29 62.32 11.04 1.48 ...
    ##  $ Other EU.c2  : num  10.64 108.34 7.83 7.68 2.46 ...
    ##  $ Other EU.c3  : num  777.96 66.48 341.26 32.68 6.84 ...
    ##  $ Other EU.c4  : num  39.4 27.5 20.8 940.6 17.6 ...
    ##  $ Other EU.c5  : num  12.26 4.55 12.19 41.99 129.34 ...
    ##  $ Other EU.c6  : num  60.13 13.52 10.17 4.8 1.25 ...
    ##  $ Other EU.c7  : num  50.69 33.42 19.76 22.72 2.67 ...
    ##  $ Other EU.c8  : num  17.85 809.32 15.23 10.64 2.34 ...
    ##  $ Other EU.c9  : num  113.52 213.9 126.76 69.75 8.33 ...
    ##  $ Other EU.c10 : num  44.43 57.71 32.84 68.93 3.44 ...
    ##  $ Other EU.c11 : num  7.53 31.36 5.04 6.88 1.13 ...
    ##  $ Other EU.c12 : num  64.6 248.6 44.5 47.3 9.9 ...
    ##  $ Other EU.c13 : num  64.5 124.6 47.5 55.4 10.4 ...
    ##  $ Other EU.c14 : num  89.5 137.1 69.1 74.7 19.8 ...
    ##  $ Other EU.c15 : num  142.4 211.8 101.6 244.8 40.1 ...
    ##  $ Other EU.c16 : num  62.4 38.2 21.1 162.7 39.8 ...
    ##  $ Other EU.c17 : num  2.991 66.15 1.675 1.355 0.348 ...
    ##  $ Other EU.c18 : num  8.92 13.164 3.565 4.342 0.822 ...
    ##  $ Other EU.c19 : num  1.75 2.77 1.34 1.76 1.26 ...
    ##  $ Other EU.c20 : num  21.15 18.93 16.26 12.13 2.73 ...
    ##  $ Other EU.c21 : num  11.4 6.51 10.22 5.16 1.55 ...
    ##  $ Other EU.c22 : num  70.59 9.8 76.62 9.61 2.1 ...
    ##  $ Other EU.c23 : num  11.69 44.75 9.41 11.22 2.3 ...
    ##  $ Other EU.c24 : num  27.56 78.13 24.81 9.2 1.77 ...
    ##  $ Other EU.c25 : num  6.891 24.092 6.855 3.886 0.755 ...
    ##  $ Other EU.c26 : num  9.485 14.647 8.501 4.527 0.938 ...
    ##  $ Other EU.c27 : num  4.607 6.278 3.775 3.254 0.747 ...
    ##  $ Other EU.c28 : num  25.21 32.57 21.25 14.73 3.19 ...
    ##  $ Other EU.c29 : num  0.621 1.1934 0.344 0.6787 0.0633 ...
    ##  $ Other EU.c30 : num  34.64 36.8 29.05 22.19 4.51 ...
    ##  $ Other EU.c31 : num  1.397 1.659 1.063 1.1 0.313 ...
    ##  $ Other EU.c32 : num  1.463 1.213 1.102 0.828 0.189 ...
    ##  $ Other EU.c33 : num  0.888 0.798 0.923 1.03 0.126 ...
    ##  $ Other EU.c34 : num  11.17 10.24 8.16 12.78 2.27 ...
    ##  $ Other EU.c35 : num  0 0 0 0 0 0 0 0 0 0 ...
    ##  $ NAFTA.c1     : num  37.214 14.391 12.03 2.745 0.592 ...
    ##  $ NAFTA.c2     : num  4.122 14.894 3.666 1.986 0.482 ...
    ##  $ NAFTA.c3     : num  53.277 10.329 20.239 2.847 0.823 ...
    ##  $ NAFTA.c4     : num  3.05 2.41 2.06 24.89 5.48 ...
    ##  $ NAFTA.c5     : num  0.449 0.147 0.47 0.575 3.529 ...
    ##  $ NAFTA.c6     : num  6.492 1.2234 0.8799 0.4851 0.0794 ...
    ##  $ NAFTA.c7     : num  6.54 5.87 3.36 5.89 3.97 ...
    ##  $ NAFTA.c8     : num  5.574 64.013 4.418 2.19 0.489 ...
    ##  $ NAFTA.c9     : num  24.82 50.61 28.56 8.99 1.66 ...
    ##  $ NAFTA.c10    : num  4.38 5.917 4 3.593 0.399 ...
    ##  $ NAFTA.c11    : num  0.652 3.375 0.496 0.448 0.112 ...
    ##  $ NAFTA.c12    : num  7.07 34.94 5.57 3.71 1.12 ...
    ##  $ NAFTA.c13    : num  10.66 23.84 8.43 8.47 1.73 ...
    ##  $ NAFTA.c14    : num  15.68 27.71 12.62 12.16 2.31 ...
    ##  $ NAFTA.c15    : num  23.9 42.3 18.8 27.8 22.4 ...
    ##  $ NAFTA.c16    : num  7.94 8.42 3.58 12.78 2.54 ...
    ##  $ NAFTA.c17    : num  0.1237 0.4121 0.1124 0.0537 0.0116 ...
    ##  $ NAFTA.c18    : num  0.0282 0.07296 0.01454 0.01408 0.00255 ...
    ##  $ NAFTA.c19    : num  0.0353 0.0654 0.0287 0.0334 0.0107 ...
    ##  $ NAFTA.c20    : num  6.78 11.93 4.91 5.98 1.63 ...
    ##  $ NAFTA.c21    : num  0.465 0.652 0.291 0.577 0.108 ...
    ##  $ NAFTA.c22    : num  2.674 0.915 1.808 0.351 0.073 ...
    ##  $ NAFTA.c23    : num  2.262 15.747 1.784 1.312 0.368 ...
    ##  $ NAFTA.c24    : num  0.523 4.759 0.43 0.402 0.109 ...
    ##  $ NAFTA.c25    : num  2.273 17.322 2.011 0.952 0.285 ...
    ##  $ NAFTA.c26    : num  0.815 5.137 0.679 0.448 0.128 ...
    ##  $ NAFTA.c27    : num  0.821 1.568 0.654 0.559 0.18 ...
    ##  $ NAFTA.c28    : num  4.137 5.529 3.417 1.639 0.533 ...
    ##  $ NAFTA.c29    : num  0.1102 0.152 0.0676 0.0447 0.0108 ...
    ##   [list output truncated]

Discussion
----------

Acknowledgements
----------------

FNS Fei Wang

References
----------

Wang, Zhi, Shang-Jin Wei, and Kunfu Zhu. 2014. “Quantifying
International Production Sharing at the Bilateral and Sector Levels.”
